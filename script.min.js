function updateWebsiteName(){document.getElementById("header").textContent="Currency Converter - Emma Juniorx Studio 2.0"}async function fetchCurrencies(){const e=document.getElementById("fromCurrency"),t=document.getElementById("toCurrency"),n=await fetch("https://open.er-api.com/v6/latest"),o=await n.json();if("success"===o.result){const n=Object.keys(o.rates);populateDropdowns(e,n),populateDropdowns(t,n)}else console.error("Failed to fetch currency codes:",o.error)}function populateDropdowns(n,e){e.forEach(e=>{var t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)})}function saveConversionToHistory(e,t,n,o){var r=JSON.parse(localStorage.getItem("conversionHistory"))||[],e={fromCurrency:e,toCurrency:t,amount:n,result:o,timestamp:(new Date).toLocaleString()};r.push(e),localStorage.setItem("conversionHistory",JSON.stringify(r))}function displayConversionHistory(){const o=document.getElementById("history-list");o.innerHTML="",(JSON.parse(localStorage.getItem("conversionHistory"))||[]).forEach((e,t)=>{var n=document.createElement("li");n.textContent=`${t+1}. ${e.amount} ${e.fromCurrency} = ${e.result} ${e.toCurrency} (${e.timestamp})`,o.appendChild(n)})}async function convertCurrency(){const e=document.getElementById("amount"),t=parseFloat(e.value);if(isNaN(t)||t<=0)document.getElementById("result").innerHTML="Please enter a valid positive number.";else{const n=document.getElementById("fromCurrency").value,o=document.getElementById("toCurrency").value,r=document.getElementById("result"),s=document.getElementById("loading");r.innerHTML="",s.style.display="none",s.style.display="block";try{const e=await fetch("https://open.er-api.com/v6/latest"),s=await e.json();if("success"!==s.result)throw new Error("Failed to fetch currency conversion.");if(s.rates.hasOwnProperty(n)&&s.rates.hasOwnProperty(o)){const e=t*(s.rates[o]/s.rates[n]);saveConversionToHistory(n,o,t,""+e.toFixed(2)),await new Promise(e=>setTimeout(e,2e3)),r.innerHTML=`${t} ${n} = ${e.toFixed(2)} `+o}else r.innerHTML="Invalid currencies selected. Please try again."}catch(e){console.error("Error fetching currency conversion:",e.message),r.innerHTML="Error fetching currency conversion. Please try again later."}finally{s.style.display="none",displayConversionHistory()}}}function toggleCurrencies(){var e=document.getElementById("fromCurrency"),t=document.getElementById("toCurrency"),n=e.value;e.value=t.value,t.value=n}function resetHistory(){localStorage.removeItem("conversionHistory"),displayConversionHistory()}document.addEventListener("DOMContentLoaded",function(){fetchCurrencies()}),document.addEventListener("DOMContentLoaded",updateWebsiteName),document.addEventListener("DOMContentLoaded",displayConversionHistory),document.addEventListener("DOMContentLoaded",displayConversionHistory);