function updateWebsiteName(){document.getElementById("header").textContent="Currency Converter - Emma Juniorx Studio 2.0"}async function fetchCurrencies(){var e=document.getElementById("fromCurrency"),t=document.getElementById("toCurrency"),n=await(await fetch("https://open.er-api.com/v6/latest")).json();"success"===n.result?(populateDropdowns(e,e=Object.keys(n.rates)),populateDropdowns(t,e)):console.error("Failed to fetch currency codes:",n.error)}function populateDropdowns(n,e){e.forEach(e=>{var t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)})}function saveConversionToHistory(e,t,n,o){var r=JSON.parse(localStorage.getItem("conversionHistory"))||[],e={fromCurrency:e,toCurrency:t,amount:n,result:o,timestamp:(new Date).toLocaleString()};r.push(e),localStorage.setItem("conversionHistory",JSON.stringify(r))}function displayConversionHistory(){const o=document.getElementById("history-list");o.innerHTML="",(JSON.parse(localStorage.getItem("conversionHistory"))||[]).forEach((e,t)=>{var n=document.createElement("li");n.textContent=`${t+1}. ${e.amount} ${e.fromCurrency} = ${e.result} ${e.toCurrency} (${e.timestamp})`,o.appendChild(n)})}async function convertCurrency(){var e=document.getElementById("amount"),e=parseFloat(e.value);if(isNaN(e)||e<=0)document.getElementById("result").innerHTML="Please enter a valid positive number.";else{var t=document.getElementById("fromCurrency").value,n=document.getElementById("toCurrency").value,o=document.getElementById("result"),r=document.getElementById("loading");o.innerHTML="",r.style.display="none",r.style.display="block";try{var a,s=await(await fetch("https://open.er-api.com/v6/latest")).json();if("success"!==s.result)throw new Error("Failed to fetch currency conversion.");s.rates.hasOwnProperty(t)&&s.rates.hasOwnProperty(n)?(saveConversionToHistory(t,n,e,""+(a=e*(s.rates[n]/s.rates[t])).toFixed(2)),await new Promise(e=>setTimeout(e,2e3)),o.innerHTML=`${e} ${t} = ${a.toFixed(2)} `+n):o.innerHTML="Invalid currencies selected. Please try again."}catch(e){console.error("Error fetching currency conversion:",e.message),o.innerHTML="Error fetching currency conversion. Please try again later."}finally{r.style.display="none",displayConversionHistory()}}}function toggleCurrencies(){var e=document.getElementById("fromCurrency"),t=document.getElementById("toCurrency"),n=e.value;e.value=t.value,t.value=n}function resetHistory(){localStorage.removeItem("conversionHistory"),displayConversionHistory()}document.addEventListener("DOMContentLoaded",function(){fetchCurrencies()}),document.addEventListener("DOMContentLoaded",updateWebsiteName),document.addEventListener("DOMContentLoaded",displayConversionHistory),document.addEventListener("DOMContentLoaded",displayConversionHistory);